<script type="text/javascript">
    var registerFirstName, registerLastName, registerEmail, registerMobile, registerYear, registerMajor, registerPassword;
    // Verify Form
    function verify(x) {
        switch (x.filter) {
            case 'RegisterPassword':
                field.pass(x, true, 'password');
                break;
            case 'RegisterConfirm':
                field.pass(x, true, 'match', $('input#RegisterPassword').val());
                break;
            case 'RegisterEmail':
                field.pass(x, true, 'uscemail');
                break;
            case 'RegisterMobile':
                field.pass(x, true, 'phone');
                break;
            case 'PaymentCardNumber':
                field.pass(x, true, 'creditcard');
                break;
            case 'PaymentCsc':
                field.pass(x, true, 'csc');
                break;
            //case 'ContactAddress':
            //    field.pass(x, true, 'alphanumeric');
            //    break;
            default:
                var simplyExist = [
                    'RegisterYear',
                    'RegisterFirstName',
                    'RegisterLastName',
                    'RegisterMajor',
                    'PaymentName',
                    'PaymentExpirationDate',
                    //,'ContactGender',
                    //,'ContactLanguagesKnown'
                ];
                if (simplyExist.indexOf(x.filter) > -1) {
                    field.pass(x);
                } else {
                    x.val;
                }
                break;
        }
    }

    /*
    Stripe.setPublishableKey('YOUR_PUBLISHABLE_KEY');
    var stripeResponseHandler = function (status, response) {
        var $form = $('form#payment');
        if (response.error) {
            // Show the errors on the form
            //$form.find('.payment-errors').text(response.error.message);
            $('div#payment-error').html(response.error.message);
            //$form.find('button').prop('disabled', false);
        }
        else {
            // token contains id, last4, and card type
            var token = response.id;
            alert('token : ' + token);
            // Insert the token into the form so it gets submitted to the server
            $form.append($('<input type="hidden" name="stripeToken" />').val(token));
            // and re-submit
            $form.get(0).submit();
        }
    };
    */

    $(document).ready(function () {
        $('#modal-registration-userinfo').show();
        $('#modal-registration-payment').hide();
        $('#modal-registration-thankyou').hide();

        $('#btn-register').click(function (event) {
            var alertString = '';
            event.preventDefault();
            allPass = field.checkAll('form#registration');
            registerFirstName = $('input[name=RegisterFirstName]').val().toUpperCase();
            alertString += 'First Name : ' + registerFirstName + '<br />';
            registerLastName = $('input[name=RegisterLastName]').val().toUpperCase();
            alertString += 'Last Name : ' + registerLastName + '<br />';
            $('span#ThankYouName').html(registerFirstName + ' ' + registerLastName);
            if ($('input[name=RegisterEmail]').val() != '') {
                registerEmail = $('input[name=RegisterEmail]').val().toLowerCase();
                alertString += 'Email : ' + registerEmail + '<br />';
                $('span#ThankYouEmail').html('(' + registerEmail + ')');
            }
            registerMobile = $('input[name=RegisterMobile]').val();
            alertString += 'Mobile : ' + registerMobile + '<br />';
            registerYear = $('select[name=RegisterYear] option:selected').val().toUpperCase();
            alertString += 'Year : ' + registerYear + '<br />';
            registerMajor = $('input[name=RegisterMajor]').val().toUpperCase();
            alertString += 'Major : ' + registerMajor + '<br />';
            if (allPass) {
                $('#modal-registration-userinfo').hide();
                $('#modal-registration-payment').hide();
                $('#modal-registration-thankyou').show();
                alertString = '<label>' + alertString + '</label>';
                $('div#user-info').html(alertString);
            }
        });

        $('#btn-submit').click(function (event) {
            var alertString = '';
            var $form = $('form#payment');
            event.preventDefault();
            allPass = field.checkAll('form#payment');
            // Disable the submit button to prevent repeated clicks
            //$form.find('button').prop('disabled', true);
            Stripe.createToken($form, stripeResponseHandler);
            alert('Test');
            // Prevent the form from submitting with the default action
            return false;
        });
    });
</script>

<a class="modal-close" href="javascript:modal.close()">X</a>

<div id="modal-registration-userinfo" class="modal-screen">
    <h1>Registration</h1>
    <form action="#" id="registration" method="post">
        <div class="col col2">
            <label for="RegisterFirstName">First Name:</label>
            <input type="text" name="RegisterFirstName" id="RegisterFirstName" value="Jack" tabindex="1" onblur="field.check(this)" />
            <label for="RegisterLastName">Last Name:</label>
            <input type="text" name="RegisterLastName" id="RegisterLastName" value="Kwan" tabindex="2" onblur="field.check(this)" />
            <label for="RegisterEmail">USC Email:</label>
            <input type="text" name="RegisterEmail" id="RegisterEmail" value="jackkwan@usc.edu" tabindex="3" onblur="field.check(this)" />
            <label for="RegisterMobile">Mobile Phone Number:</label>
            <input type="text" name="RegisterMobile" id="RegisterMobile" value="(123) 456-7890" tabindex="4" onblur="field.check(this)" />
        </div>
        <div class="col col2">
            <div class="year-major">
                <label for="RegisterYear">Year:</label>
                <label for="RegisterMajor">Major:</label>
                <span class="dropdown">
                    <select name="RegisterYear" id="RegisterYear" tabindex="5" onblur="field.check(this)">
                        <option value=""></option>
                        <option value="freshman">FRESHMAN</option>
                        <option value="sophomore">SOPHOMORE</option>
                        <option value="junior">JUNIOR</option>
                        <option value="senior" selected="selected">SENIOR</option>
                        <option value="graduate">GRADUATE</option>
                    </select>
                </span>
                <input type="text" name="RegisterMajor" id="RegisterMajor" value="Computer Science" tabindex="6" onblur="field.check(this)" />
                <div class="clear"></div>
            </div>
            <label for="RegisterPassword">Password:</label>
            <input type="password" name="RegisterPassword" id="RegisterPassword" value="123456Mn" tabindex="7" onblur="field.check(this)" />
            <label for="RegisterConfirm">Confirm Password:</label>
            <input type="password" name="RegisterConfirm" id="RegisterConfirm" value="123456Mn" tabindex="8" onblur="field.check(this)" />
        </div>
        <div class="action-buttons">
            <a id="btn-register" class="go" href="#" tabindex="9">Register &nbsp; &gt;</a>
        </div>
    </form>
</div>

<div id="modal-registration-thankyou" class="modal-screen">
    <h1>Thank you!</h1>
    <div class="col">
        <div id="welcome">
            Hey <span id="ThankYouName"></span>, and welcome to USC SCIA!<br /><br />
            We're super excited that you decided to become a part of the south indian community here at USC and we can't wait to begin showing you
            what SCIA is all about. Before we can get started we need to verify your account.  Simply retrieve the confirmation code from your email
            <span id="ThankYouEmail"></span> and log into your SCIA account to complete the verification process.<br /><br />
            Cheers,<br/>
            SCIA Executive Board<br /><br />
        </div>
        <div id="user-info">
        </div>
    </div>
    <div class="action-buttons">
        <a id="btn-close" class="go" href="javascript:modal.close()" tabindex="1">X &nbsp; Close</a>
    </div>
</div>

<div id="modal-registration-payment" class="modal-screen">
    <h1>Registration - Payment</h1>
    <form action="#" id="payment" method="post">
        <div class="col col2">
            <label for="PaymentCardNumber">Card Number:</label>
            <input type="text" name="PaymentCardNumber" id="PaymentCardNumber" value="" tabindex="1" onblur="field.check(this)" />
            <label for="PaymentName">Name:</label>
            <input type="text" name="PaymentName" id="PaymentName" value="" tabindex="2" onblur="field.check(this)" />
            <label for="PaymentCsc">CSC:</label>
            <input type="text" name="PaymentCsc" id="PaymentCsc" value="" tabindex="3" onblur="field.check(this)" />
            <label for="PaymentExpirationDate">Expiration Date:</label>
            <input type="text" name="PaymentExpirationDate" id="PaymentExpirationDate" value="" tabindex="4" onblur="field.check(this)" />
        </div>
        <div class="col col2">
            <div id="payment-error"></div>
        </div>
        <div class="action-buttons">
            <a id="btn-submit" class="go" href="#" tabindex="5">Submit &nbsp; &gt;</a>
        </div>
    </form>
</div>